## XtSe系列训练/测试说明
### 一、模型结构说明
本方案一共用到5个模型训练，每个模型基于5折数据进行训练（其中4份作为训练集，另外1份作为验证集），各模型之间的差异如下表所示
| 模型类别 | ResXt50 | ResXt56 | ResXt128 | ResXt101 | ResDSe50 |
| -------- | -------- | -------- | -------- | -------- | -------- |
| 采样频率 | 64 | 64|  128 | 64|  64 |
| heatmap尺寸 | 28x56 | 56x56|  28x56 | 28x56 |  28x56 |
| attention | 时间维度 | 时间维度|  时间维度 | 时间维度|  时间维度+channel维度 |
| 显存占用 | 11G     | 22G    |  20G    | 21G    |  11G   |

### 二、数据准备(Optional)
本方案对原始数据进行了5折交叉验证，使用了sklearn的StratifiedKFold库，本项目里包含了已分好的5折数据,为了更好的复现结果，建议直接使用已分好的数据
如有兴趣，可重新分折，执行
```
python tools/split_crossval.py
```
可能需要安装scikit-learn

### 三、训练脚本
一共要训练5各模型，每个模型要训练5折数据，可以根据每个模型的显存占用情况，合理分配每张卡上可训练的模型数量，以ResXt50为例，占用显存11G，可在32G内存上的卡上部署两个模型，这样对train.sh里面的内容进行相应修改。然后执行
```
sh train.sh
```
### 四、训练策略

**本方案采取了余弦退火学习率+冷重启的方式，初始以0.1的学习率训练180个epoch,然后重新以0.7的学习率重新训练120个epoch**
因此在每个模型训练完180个epoch后，重新执行训练脚本，再次训练120个epoch
在train.sh脚本里所有模型训练完毕后，执行retrain.sh脚本
```
sh retrain.sh
```
### 五、快速测试(用已训练好的模型)
将fast_test.sh文件中对应部分取消注释，执行测试脚本，生产相应模型的预测csv文件

### 六、训练完成后测试
将test.sh文件中对应部分取消注释，执行测试脚本，生产相应模型的预测csv文件


